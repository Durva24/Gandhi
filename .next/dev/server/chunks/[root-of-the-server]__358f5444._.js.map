{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Gandhi/app/api/get/transactions/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { createClient } from '@supabase/supabase-js';\n\nconst supabase = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n);\n\nexport async function GET(request: NextRequest) {\n  try {\n    const userId = request.nextUrl.searchParams.get('userId') || process.env.TEST_USER_ID;\n    const transactionId = request.nextUrl.searchParams.get('transactionId');\n    const accountId = request.nextUrl.searchParams.get('accountId');\n    const categoryId = request.nextUrl.searchParams.get('categoryId');\n    const type = request.nextUrl.searchParams.get('type'); // income/expense\n    const startDate = request.nextUrl.searchParams.get('startDate');\n    const endDate = request.nextUrl.searchParams.get('endDate');\n    const month = request.nextUrl.searchParams.get('month'); // YYYY-MM\n    const limit = request.nextUrl.searchParams.get('limit');\n\n    if (!userId) {\n      return NextResponse.json({ error: 'userId required' }, { status: 400 });\n    }\n\n    let query = supabase\n      .from('transactions')\n      .select('*, accounts(account_name), categories(name)')\n      .eq('user_id', userId);\n\n    if (transactionId) {\n      query = query.eq('id', transactionId);\n    }\n    if (accountId) {\n      query = query.eq('account_id', accountId);\n    }\n    if (categoryId) {\n      query = query.eq('category_id', categoryId);\n    }\n    if (type) {\n      query = query.eq('type', type);\n    }\n    if (startDate) {\n      query = query.gte('date', startDate);\n    }\n    if (endDate) {\n      query = query.lte('date', endDate);\n    }\n    if (month) {\n      const [year, monthNum] = month.split('-');\n      const startOfMonth = `${year}-${monthNum}-01`;\n      const endOfMonth = new Date(parseInt(year), parseInt(monthNum), 0).toISOString().split('T')[0];\n      query = query.gte('date', startOfMonth).lte('date', endOfMonth);\n    }\n    if (limit) {\n      query = query.limit(parseInt(limit));\n    }\n\n    query = query.order('date', { ascending: false });\n\n    const { data, error } = await query;\n\n    if (error) throw error;\n\n    return NextResponse.json({ success: true, data, count: data?.length || 0 });\n  } catch (error: any) {\n    return NextResponse.json({ success: false, error: error.message }, { status: 500 });\n  }\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,WAAW,IAAA,yMAAY;AAKtB,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,SAAS,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,aAAa,QAAQ,GAAG,CAAC,YAAY;QACrF,MAAM,gBAAgB,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;QACvD,MAAM,YAAY,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;QACnD,MAAM,aAAa,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;QACpD,MAAM,OAAO,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,SAAS,iBAAiB;QACxE,MAAM,YAAY,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;QACnD,MAAM,UAAU,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;QACjD,MAAM,QAAQ,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,UAAU,UAAU;QACnE,MAAM,QAAQ,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;QAE/C,IAAI,CAAC,QAAQ;YACX,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkB,GAAG;gBAAE,QAAQ;YAAI;QACvE;QAEA,IAAI,QAAQ,SACT,IAAI,CAAC,gBACL,MAAM,CAAC,+CACP,EAAE,CAAC,WAAW;QAEjB,IAAI,eAAe;YACjB,QAAQ,MAAM,EAAE,CAAC,MAAM;QACzB;QACA,IAAI,WAAW;YACb,QAAQ,MAAM,EAAE,CAAC,cAAc;QACjC;QACA,IAAI,YAAY;YACd,QAAQ,MAAM,EAAE,CAAC,eAAe;QAClC;QACA,IAAI,MAAM;YACR,QAAQ,MAAM,EAAE,CAAC,QAAQ;QAC3B;QACA,IAAI,WAAW;YACb,QAAQ,MAAM,GAAG,CAAC,QAAQ;QAC5B;QACA,IAAI,SAAS;YACX,QAAQ,MAAM,GAAG,CAAC,QAAQ;QAC5B;QACA,IAAI,OAAO;YACT,MAAM,CAAC,MAAM,SAAS,GAAG,MAAM,KAAK,CAAC;YACrC,MAAM,eAAe,GAAG,KAAK,CAAC,EAAE,SAAS,GAAG,CAAC;YAC7C,MAAM,aAAa,IAAI,KAAK,SAAS,OAAO,SAAS,WAAW,GAAG,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;YAC9F,QAAQ,MAAM,GAAG,CAAC,QAAQ,cAAc,GAAG,CAAC,QAAQ;QACtD;QACA,IAAI,OAAO;YACT,QAAQ,MAAM,KAAK,CAAC,SAAS;QAC/B;QAEA,QAAQ,MAAM,KAAK,CAAC,QAAQ;YAAE,WAAW;QAAM;QAE/C,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM;QAE9B,IAAI,OAAO,MAAM;QAEjB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM;YAAM,OAAO,MAAM,UAAU;QAAE;IAC3E,EAAE,OAAO,OAAY;QACnB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnF;AACF"}}]
}