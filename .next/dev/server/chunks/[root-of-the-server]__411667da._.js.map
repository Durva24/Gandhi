{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Gandhi/app/api/get/funds/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { createClient } from '@supabase/supabase-js';\n\nconst supabase = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n);\n\nexport async function GET(request: NextRequest) {\n  try {\n    const userId = request.nextUrl.searchParams.get('userId') || process.env.TEST_USER_ID;\n    const fundId = request.nextUrl.searchParams.get('fundId');\n    const name = request.nextUrl.searchParams.get('name');\n\n    if (!userId) {\n      return NextResponse.json({ error: 'userId required' }, { status: 400 });\n    }\n\n    let query = supabase.from('funds').select('*').eq('user_id', userId);\n\n    if (fundId) {\n      query = query.eq('id', fundId);\n    }\n    if (name) {\n      query = query.ilike('name', `%${name}%`);\n    }\n\n    query = query.order('created_at', { ascending: false });\n\n    const { data, error } = await query;\n\n    if (error) throw error;\n\n    // Add progress percentage to each fund\n    const dataWithProgress = data?.map(fund => ({\n      ...fund,\n      progress: ((parseFloat(fund.current_amount) / parseFloat(fund.target_amount)) * 100).toFixed(2)\n    }));\n\n    const totalTarget = data?.reduce((sum, f) => sum + parseFloat(f.target_amount), 0) || 0;\n    const totalCurrent = data?.reduce((sum, f) => sum + parseFloat(f.current_amount), 0) || 0;\n\n    return NextResponse.json({\n      success: true,\n      data: dataWithProgress,\n      count: data?.length || 0,\n      summary: {\n        totalTarget,\n        totalCurrent,\n        overallProgress: totalTarget > 0 ? ((totalCurrent / totalTarget) * 100).toFixed(2) : 0\n      }\n    });\n  } catch (error: any) {\n    return NextResponse.json({ success: false, error: error.message }, { status: 500 });\n  }\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,WAAW,IAAA,yMAAY;AAKtB,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,SAAS,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,aAAa,QAAQ,GAAG,CAAC,YAAY;QACrF,MAAM,SAAS,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;QAChD,MAAM,OAAO,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;QAE9C,IAAI,CAAC,QAAQ;YACX,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkB,GAAG;gBAAE,QAAQ;YAAI;QACvE;QAEA,IAAI,QAAQ,SAAS,IAAI,CAAC,SAAS,MAAM,CAAC,KAAK,EAAE,CAAC,WAAW;QAE7D,IAAI,QAAQ;YACV,QAAQ,MAAM,EAAE,CAAC,MAAM;QACzB;QACA,IAAI,MAAM;YACR,QAAQ,MAAM,KAAK,CAAC,QAAQ,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;QACzC;QAEA,QAAQ,MAAM,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAErD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM;QAE9B,IAAI,OAAO,MAAM;QAEjB,uCAAuC;QACvC,MAAM,mBAAmB,MAAM,IAAI,CAAA,OAAQ,CAAC;gBAC1C,GAAG,IAAI;gBACP,UAAU,CAAC,AAAC,WAAW,KAAK,cAAc,IAAI,WAAW,KAAK,aAAa,IAAK,GAAG,EAAE,OAAO,CAAC;YAC/F,CAAC;QAED,MAAM,cAAc,MAAM,OAAO,CAAC,KAAK,IAAM,MAAM,WAAW,EAAE,aAAa,GAAG,MAAM;QACtF,MAAM,eAAe,MAAM,OAAO,CAAC,KAAK,IAAM,MAAM,WAAW,EAAE,cAAc,GAAG,MAAM;QAExF,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM;YACN,OAAO,MAAM,UAAU;YACvB,SAAS;gBACP;gBACA;gBACA,iBAAiB,cAAc,IAAI,CAAC,AAAC,eAAe,cAAe,GAAG,EAAE,OAAO,CAAC,KAAK;YACvF;QACF;IACF,EAAE,OAAO,OAAY;QACnB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnF;AACF"}}]
}