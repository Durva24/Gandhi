{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Gandhi/app/api/get/bills/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { createClient } from '@supabase/supabase-js';\n\nconst supabase = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n);\n\nexport async function GET(request: NextRequest) {\n  try {\n    const userId = request.nextUrl.searchParams.get('userId') || process.env.TEST_USER_ID;\n    const billId = request.nextUrl.searchParams.get('billId');\n    const status = request.nextUrl.searchParams.get('status'); // pending/paid\n    const recurrence = request.nextUrl.searchParams.get('recurrence');\n    const upcoming = request.nextUrl.searchParams.get('upcoming'); // true/false\n    const overdue = request.nextUrl.searchParams.get('overdue'); // true/false\n\n    if (!userId) {\n      return NextResponse.json({ error: 'userId required' }, { status: 400 });\n    }\n\n    let query = supabase\n      .from('bills')\n      .select('*, accounts(account_name)')\n      .eq('user_id', userId);\n\n    if (billId) {\n      query = query.eq('id', billId);\n    }\n    if (status) {\n      query = query.eq('status', status);\n    }\n    if (recurrence) {\n      query = query.eq('recurrence', recurrence);\n    }\n    if (upcoming === 'true') {\n      const today = new Date().toISOString().split('T')[0];\n      const futureDate = new Date();\n      futureDate.setDate(futureDate.getDate() + 30);\n      query = query.gte('due_date', today).lte('due_date', futureDate.toISOString().split('T')[0]);\n    }\n    if (overdue === 'true') {\n      const today = new Date().toISOString().split('T')[0];\n      query = query.lt('due_date', today).eq('status', 'pending');\n    }\n\n    query = query.order('due_date', { ascending: true });\n\n    const { data, error } = await query;\n\n    if (error) throw error;\n\n    return NextResponse.json({ success: true, data, count: data?.length || 0 });\n  } catch (error: any) {\n    return NextResponse.json({ success: false, error: error.message }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,WAAW,IAAA,yMAAY;AAKtB,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,SAAS,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,aAAa,QAAQ,GAAG,CAAC,YAAY;QACrF,MAAM,SAAS,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;QAChD,MAAM,SAAS,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,WAAW,eAAe;QAC1E,MAAM,aAAa,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;QACpD,MAAM,WAAW,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,aAAa,aAAa;QAC5E,MAAM,UAAU,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,YAAY,aAAa;QAE1E,IAAI,CAAC,QAAQ;YACX,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkB,GAAG;gBAAE,QAAQ;YAAI;QACvE;QAEA,IAAI,QAAQ,SACT,IAAI,CAAC,SACL,MAAM,CAAC,6BACP,EAAE,CAAC,WAAW;QAEjB,IAAI,QAAQ;YACV,QAAQ,MAAM,EAAE,CAAC,MAAM;QACzB;QACA,IAAI,QAAQ;YACV,QAAQ,MAAM,EAAE,CAAC,UAAU;QAC7B;QACA,IAAI,YAAY;YACd,QAAQ,MAAM,EAAE,CAAC,cAAc;QACjC;QACA,IAAI,aAAa,QAAQ;YACvB,MAAM,QAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;YACpD,MAAM,aAAa,IAAI;YACvB,WAAW,OAAO,CAAC,WAAW,OAAO,KAAK;YAC1C,QAAQ,MAAM,GAAG,CAAC,YAAY,OAAO,GAAG,CAAC,YAAY,WAAW,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;QAC7F;QACA,IAAI,YAAY,QAAQ;YACtB,MAAM,QAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;YACpD,QAAQ,MAAM,EAAE,CAAC,YAAY,OAAO,EAAE,CAAC,UAAU;QACnD;QAEA,QAAQ,MAAM,KAAK,CAAC,YAAY;YAAE,WAAW;QAAK;QAElD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM;QAE9B,IAAI,OAAO,MAAM;QAEjB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM;YAAM,OAAO,MAAM,UAAU;QAAE;IAC3E,EAAE,OAAO,OAAY;QACnB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnF;AACF"}}]
}